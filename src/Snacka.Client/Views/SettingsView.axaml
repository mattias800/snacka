<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Snacka.Client.ViewModels"
             xmlns:conv="using:Snacka.Client.Converters"
             xmlns:Views="using:Snacka.Client.Views"
             xmlns:ui="using:FluentAvalonia.UI.Controls"
             x:Class="Snacka.Client.Views.SettingsView"
             x:DataType="vm:SettingsViewModel">

    <Grid Background="{StaticResource BackgroundBrush}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="240"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Left Menu Panel -->
        <Border Grid.Column="0" Background="{StaticResource Content1Brush}">
            <DockPanel>
                <!-- Header with back button -->
                <Border DockPanel.Dock="Top" Padding="20,16" Background="{StaticResource BackgroundBrush}">
                    <Grid>
                        <Button Command="{Binding CloseCommand}"
                                HorizontalAlignment="Left"
                                Classes="btn-ghost"
                                Padding="12,8">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <ui:SymbolIcon Symbol="Dismiss" FontSize="14" Foreground="{StaticResource Foreground3Brush}"/>
                                <TextBlock Text="ESC" FontSize="11" Foreground="{StaticResource Foreground3Brush}" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <TextBlock Text="Settings"
                                   HorizontalAlignment="Right"
                                   FontSize="16"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource ForegroundBrush}"
                                   VerticalAlignment="Center"/>
                    </Grid>
                </Border>

                <!-- Menu Categories -->
                <ScrollViewer DockPanel.Dock="Top" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12,16">
                        <!-- App Settings Section -->
                        <TextBlock Text="APP SETTINGS"
                                   FontSize="11"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource Foreground3Brush}"
                                   Margin="12,0,0,12"/>

                        <!-- Voice & Video -->
                        <Button Command="{Binding SelectCategoryCommand}"
                                CommandParameter="Voice &amp; Video"
                                Background="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryBackgroundConverter.Instance}, ConverterParameter='Voice &amp; Video'}"
                                BorderThickness="0"
                                HorizontalContentAlignment="Left"
                                Padding="12,10"
                                Margin="0,2"
                                CornerRadius="10"
                                Cursor="Hand">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <ui:SymbolIcon Symbol="Speaker2" FontSize="16" Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='Voice &amp; Video'}"/>
                                <TextBlock Text="Voice &amp; Video"
                                           Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='Voice &amp; Video'}"
                                           FontSize="14"/>
                            </StackPanel>
                        </Button>

                        <!-- Video -->
                        <Button Command="{Binding SelectCategoryCommand}"
                                CommandParameter="Video"
                                Background="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryBackgroundConverter.Instance}, ConverterParameter='Video'}"
                                BorderThickness="0"
                                HorizontalContentAlignment="Left"
                                Padding="12,10"
                                Margin="0,2"
                                CornerRadius="10"
                                Cursor="Hand">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <ui:SymbolIcon Symbol="Video" FontSize="16" Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='Video'}"/>
                                <TextBlock Text="Video"
                                           Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='Video'}"
                                           FontSize="14"/>
                            </StackPanel>
                        </Button>

                        <!-- Controllers -->
                        <Button Command="{Binding SelectCategoryCommand}"
                                CommandParameter="Controllers"
                                Background="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryBackgroundConverter.Instance}, ConverterParameter='Controllers'}"
                                BorderThickness="0"
                                HorizontalContentAlignment="Left"
                                Padding="12,10"
                                Margin="0,2"
                                CornerRadius="10"
                                Cursor="Hand"
                                IsVisible="{Binding HasControllerSettings}">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <ui:SymbolIcon Symbol="AllApps" FontSize="16" Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='Controllers'}"/>
                                <TextBlock Text="Controllers"
                                           Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='Controllers'}"
                                           FontSize="14"/>
                            </StackPanel>
                        </Button>

                        <!-- User Settings Section -->
                        <TextBlock Text="USER SETTINGS"
                                   FontSize="11"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource Foreground3Brush}"
                                   Margin="12,24,0,12"/>

                        <Button Command="{Binding SelectCategoryCommand}"
                                CommandParameter="My Account"
                                Background="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryBackgroundConverter.Instance}, ConverterParameter='My Account'}"
                                BorderThickness="0"
                                HorizontalContentAlignment="Left"
                                Padding="12,10"
                                Margin="0,2"
                                CornerRadius="10"
                                Cursor="Hand">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <ui:SymbolIcon Symbol="Contact" FontSize="16" Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='My Account'}"/>
                                <TextBlock Text="My Account"
                                           Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='My Account'}"
                                           FontSize="14"/>
                            </StackPanel>
                        </Button>

                        <Button Command="{Binding SelectCategoryCommand}"
                                CommandParameter="Appearance"
                                IsEnabled="False"
                                Background="Transparent"
                                BorderThickness="0"
                                HorizontalContentAlignment="Left"
                                Padding="12,10"
                                Margin="0,2"
                                CornerRadius="10">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <ui:SymbolIcon Symbol="OpenPane" FontSize="16" Foreground="{StaticResource Foreground3Brush}"/>
                                <TextBlock Text="Appearance"
                                           Foreground="{StaticResource Foreground3Brush}"
                                           FontSize="14"/>
                            </StackPanel>
                        </Button>

                        <!-- Server Admin Section (only visible for admins) -->
                        <StackPanel IsVisible="{Binding IsServerAdmin}">
                            <TextBlock Text="SERVER ADMIN"
                                       FontSize="11"
                                       FontWeight="SemiBold"
                                       Foreground="{StaticResource Foreground3Brush}"
                                       Margin="12,24,0,12"/>

                            <Button Command="{Binding SelectCategoryCommand}"
                                    CommandParameter="Server Admin"
                                    Background="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryBackgroundConverter.Instance}, ConverterParameter='Server Admin'}"
                                    BorderThickness="0"
                                    HorizontalContentAlignment="Left"
                                    Padding="12,10"
                                    Margin="0,2"
                                    CornerRadius="10"
                                    Cursor="Hand">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <ui:SymbolIcon Symbol="Settings" FontSize="16" Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='Server Admin'}"/>
                                    <TextBlock Text="Server Admin"
                                               Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='Server Admin'}"
                                               FontSize="14"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>

                        <!-- About Section -->
                        <TextBlock Text="INFO"
                                   FontSize="11"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource Foreground3Brush}"
                                   Margin="12,24,0,12"/>

                        <Button Command="{Binding SelectCategoryCommand}"
                                CommandParameter="About"
                                Background="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryBackgroundConverter.Instance}, ConverterParameter='About'}"
                                BorderThickness="0"
                                HorizontalContentAlignment="Left"
                                Padding="12,10"
                                Margin="0,2"
                                CornerRadius="10"
                                Cursor="Hand">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <ui:SymbolIcon Symbol="Help" FontSize="16" Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='About'}"/>
                                <TextBlock Text="About"
                                           Foreground="{Binding SelectedCategory, Converter={x:Static conv:SettingsCategoryForegroundConverter.Instance}, ConverterParameter='About'}"
                                           FontSize="14"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </ScrollViewer>
            </DockPanel>
        </Border>

        <!-- Content Area -->
        <Border Grid.Column="1" Padding="48,24" Background="{StaticResource Content2Brush}">
            <ContentControl Content="{Binding CurrentPage}">
                <ContentControl.DataTemplates>
                    <DataTemplate DataType="{x:Type vm:AudioSettingsViewModel}">
                        <Views:AudioSettingsView/>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type vm:VideoSettingsViewModel}">
                        <Views:VideoSettingsView/>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type vm:ControllerSettingsViewModel}">
                        <Views:ControllerSettingsView/>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type vm:AccountSettingsViewModel}">
                        <Views:AccountSettingsView/>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type vm:AdminPanelViewModel}">
                        <Views:AdminPanelView/>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type vm:AboutSettingsViewModel}">
                        <Views:AboutSettingsView/>
                    </DataTemplate>
                </ContentControl.DataTemplates>
            </ContentControl>
        </Border>
    </Grid>
</UserControl>
